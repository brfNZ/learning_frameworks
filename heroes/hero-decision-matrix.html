<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simplified Hero Decision Matrix</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        .hero-icon {
            width: 32px;
            height: 32px;
            fill: none;
            stroke: currentColor;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
        }
        .small-icon {
            width: 20px;
            height: 20px;
            fill: none;
            stroke: currentColor;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
        }
        .rating-container {
            display: flex;
            justify-content: center;
            gap: 8px;
            align-items: flex-start;
        }
        .rating-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 80px;
        }
        .rating-btn {
            width: 40px;
            height: 40px;
            padding: 0;
            border-radius: 50%;
            transition: all 0.3s;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .rating-label {
            text-align: center;
            min-width: 80px;
            font-size: 12px;
            margin-top: 4px;
            white-space: nowrap;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div id="app"></div>

    <script>
        // State management
        let state = {
            decision: '',
            options: ['', ''],
            currentStep: 0,
            responses: {},
            showResults: false,
            selectedQuestions: []
        };

        // Heroes configuration with all questions
        const heroesQuestions = {
            spiritual: {
                name: "Spiritual Wisdom",
                color: "bg-purple-100 border-purple-300 text-purple-800",
                core: "What does my inner wisdom say about each option?",
                questions: [
                    "Which option comes from love rather than fear?",
                    "How does this serve the greater good beyond just myself?",
                    "What would I choose if I were completely unattached to the outcome?"
                ],
                focus: "Divine guidance and intuition"
            },
            socrates: {
                name: "Socrates",
                color: "bg-blue-100 border-blue-300 text-blue-800",
                core: "What assumptions am I making that I haven't examined?",
                questions: [
                    "What would happen if I'm completely wrong about this?",
                    "What do I truly know vs. what do I think I know?",
                    "What questions should I be asking that I'm not?"
                ],
                focus: "Questioning assumptions and seeking truth"
            },
            aristotle: {
                name: "Aristotle",
                color: "bg-orange-100 border-orange-300 text-orange-800",
                core: "What are the logical consequences of each option?",
                questions: [
                    "Which choice leads to the most flourishing (eudaimonia)?",
                    "What would the virtuous person do in this situation?",
                    "Which option represents the golden mean between extremes?"
                ],
                focus: "Logical analysis and virtue"
            },
            aynRand: {
                name: "Ayn Rand",
                color: "bg-green-100 border-green-300 text-green-800",
                core: "Which option best serves my rational self-interest?",
                questions: [
                    "Am I making this choice based on my own judgment or others' expectations?",
                    "Which option creates the most genuine value?",
                    "Does this align with my core principles and values?"
                ],
                focus: "Independent rational judgment"
            }
        };

        // Helper functions
        function addOption() {
            if (state.options.length < 5) {
                state.options.push('');
                render();
            }
        }

        function removeOption(index) {
            if (state.options.length > 2) {
                state.options.splice(index, 1);
                render();
            }
        }

        function updateOption(index, value) {
            state.options[index] = value;
        }

        function generateQuestions() {
            const questions = [];
            const heroOrder = ['spiritual', 'socrates', 'aristotle', 'aynRand'];
            
            // Add 4 core questions in fixed order
            heroOrder.forEach(heroKey => {
                const hero = heroesQuestions[heroKey];
                questions.push({
                    hero: hero.name,
                    question: hero.core,
                    color: hero.color,
                    focus: hero.focus,
                    isCore: true
                });
            });

            // Add 4 random specific questions, one from each hero in order
            heroOrder.forEach(heroKey => {
                const hero = heroesQuestions[heroKey];
                const randomIndex = Math.floor(Math.random() * hero.questions.length);
                questions.push({
                    hero: hero.name,
                    question: hero.questions[randomIndex],
                    color: hero.color,
                    focus: hero.focus,
                    isCore: false
                });
            });

            // Add 1 additional random question from any hero
            const allHeroes = Object.values(heroesQuestions);
            const randomHero = allHeroes[Math.floor(Math.random() * allHeroes.length)];
            const availableQuestions = randomHero.questions.filter(q => 
                !questions.some(existing => existing.question === q)
            );
            
            if (availableQuestions.length > 0) {
                const randomQuestion = availableQuestions[Math.floor(Math.random() * availableQuestions.length)];
                questions.push({
                    hero: randomHero.name,
                    question: randomQuestion,
                    color: randomHero.color,
                    focus: randomHero.focus,
                    isCore: false
                });
            }

            return questions;
        }

        function handleResponse(questionIndex, optionIndex, rating) {
            const key = `${questionIndex}-${optionIndex}`;
            state.responses[key] = rating;
        }

        function calculateScores() {
            const scores = state.options.map(() => ({ total: 0, breakdown: {} }));
            
            state.selectedQuestions.forEach((question, questionIndex) => {
                state.options.forEach((option, optionIndex) => {
                    const key = `${questionIndex}-${optionIndex}`;
                    const response = state.responses[key] || 0;
                    scores[optionIndex].total += response;
                    
                    if (!scores[optionIndex].breakdown[question.hero]) {
                        scores[optionIndex].breakdown[question.hero] = 0;
                    }
                    scores[optionIndex].breakdown[question.hero] += response;
                });
            });

            return scores;
        }

        function resetMatrix() {
            state = {
                decision: '',
                options: ['', ''],
                currentStep: 0,
                responses: {},
                showResults: false,
                selectedQuestions: []
            };
            render();
        }

        function getRatingLabel(rating) {
            const labels = {
                1: 'Not suitable',
                2: '', // Intentionally blank for alignment
                3: '', // Intentionally blank for alignment
                4: '', // Intentionally blank for alignment
                5: 'Highly suitable'
            };
            return labels[rating] || '';
        }

        // Export functions
        function exportToCSV() {
            const scores = calculateScores();
            const maxScore = Math.max(...scores.map(s => s.total));
            let csv = 'Question #,Hero,Question Text';
            state.options.forEach((opt, i) => {
                csv += `,Option ${i+1} Rating (${opt}),Option ${i+1} Total (${scores[i].total}/${state.selectedQuestions.length * 5})`;
            });
            csv += '\n';
            state.selectedQuestions.forEach((q, i) => {
                csv += `${i+1},"${q.hero}","${q.question.replace(/"/g, '""')}"`;
                state.options.forEach((opt, optIndex) => {
                    const rating = state.responses[`${i}-${optIndex}`] || '';
                    csv += `,${rating}`;
                });
                csv += '\n';
            });

            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `hero-decision-matrix-${Date.now()}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        async function exportToPDF() {
            const scores = calculateScores();
            const maxScore = Math.max(...scores.map(s => s.total));
            const exportDiv = document.createElement('div');
            exportDiv.style.cssText = 'font-family: Arial, sans-serif; padding: 20px; max-width: 800px; margin: 0 auto;';
            exportDiv.innerHTML = `
                <h1 style="text-align: center; margin-bottom: 20px;">Hero Decision Matrix Results</h1>
                <p><strong>Decision:</strong> ${state.decision}</p>
                <p><strong>Exported:</strong> ${new Date().toLocaleDateString()}</p>
                <h2 style="margin-top: 30px;">Summary</h2>
                <table style="width: 100%; border-collapse: collapse;">
                    ${state.options.map((opt, i) => `
                        <tr>
                            <td style="border: 1px solid #ddd; padding: 8px;">${opt}</td>
                            <td style="border: 1px solid #ddd; padding: 8px; font-weight: bold;">${scores[i].total}/45</td>
                        </tr>
                    `).join('')}
                </table>
            `;
            document.body.appendChild(exportDiv);

            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF('p', 'mm', 'a4');
            const canvas = await html2canvas(exportDiv);
            const imgData = canvas.toDataURL('image/png');
            pdf.addImage(imgData, 'PNG', 10, 10, 190, 0);
            pdf.save(`hero-decision-matrix-${Date.now()}.pdf`);
            
            document.body.removeChild(exportDiv);
        }

        async function exportSlideshowPDF() {
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF('p', 'mm', 'a4');
            let isFirst = true;

            async function addPage(content) {
                const div = document.createElement('div');
                div.style.cssText = 'font-family: Arial, sans-serif; padding: 20px; width: 595px; min-height: 842px; background: white; box-sizing: border-box;';
                div.innerHTML = content;
                document.body.appendChild(div);

                const canvas = await html2canvas(div, { 
                    backgroundColor: '#ffffff',
                    scale: 1,
                    width: 595,
                    height: 842,
                    useCORS: true
                });
                const imgData = canvas.toDataURL('image/png');
                
                if (!isFirst) pdf.addPage();
                isFirst = false;
                
                const imgWidth = 210;
                const imgHeight = 297;
                pdf.addImage(imgData, 'PNG', 0, 0, imgWidth, imgHeight);
                
                document.body.removeChild(div);
            }

            // Title slide
            await addPage(`
                <div style="text-align: center; padding-top: 100px;">
                    <h1 style="font-size: 36px; margin-bottom: 30px;">Hero Decision Matrix</h1>
                    <h2 style="font-size: 24px; margin-bottom: 20px;">Decision Analysis</h2>
                    <p style="font-size: 18px;">${state.decision}</p>
                    <p style="font-size: 14px; margin-top: 40px;">${new Date().toLocaleDateString()}</p>
                </div>
            `);

            // Options page
            await addPage(`
                <h1 style="text-align: center; margin-bottom: 40px;">Your Options</h1>
                ${state.options.map((opt, i) => `
                    <p style="margin: 20px 0; padding: 15px; background: #f3f4f6; border-radius: 8px;">
                        <strong>Option ${i + 1}:</strong> ${opt}
                    </p>
                `).join('')}
            `);

            // Question slides
            for (let i = 0; i < state.selectedQuestions.length; i++) {
                const q = state.selectedQuestions[i];
                await addPage(`
                    <div style="text-align: center; margin-bottom: 30px;">
                        <h2>${q.hero}</h2>
                        <p style="font-size: 14px;">${q.focus}</p>
                    </div>
                    <h3 style="text-align: center; margin-bottom: 25px;">${q.question}</h3>
                    <table style="width: 100%; border-collapse: collapse;">
                        <tr style="background: #f9fafb;">
                            <th style="border: 1px solid #ddd; padding: 8px;">Option</th>
                            <th style="border: 1px solid #ddd; padding: 8px;">Rating</th>
                        </tr>
                        ${state.options.map((opt, oi) => `
                            <tr>
                                <td style="border: 1px solid #ddd; padding: 8px;">${opt}</td>
                                <td style="border: 1px solid #ddd; padding: 8px; text-align: center;">${state.responses[`${i}-${oi}`] || ''}</td>
                            </tr>
                        `).join('')}
                    </table>
                `);
            }

            // Comprehensive Summary slide (replacing previous results and text summary slides)
            const scores = calculateScores();
            const maxScore = Math.max(...scores.map(s => s.total));
            await addPage(`
                <h1 style="text-align: center; margin-bottom: 30px;">Comprehensive Decision Analysis</h1>
                <h2 style="margin-top: 20px; margin-bottom: 10px;">Final Results</h2>
                <table style="width: 100%; border-collapse: collapse; margin-bottom: 20px;">
                    <tr style="background: #f9fafb;">
                        <th style="border: 1px solid #ddd; padding: 8px;">Option</th>
                        <th style="border: 1px solid #ddd; padding: 8px;">Score</th>
                    </tr>
                    ${state.options.map((opt, i) => `
                        <tr>
                            <td style="border: 1px solid #ddd; padding: 8px;">${opt}</td>
                            <td style="border: 1px solid #ddd; padding: 8px; text-align: center; font-weight: bold;">${scores[i].total}/45 ${scores[i].total === maxScore ? '🏆' : ''}</td>
                        </tr>
                    `).join('')}
                </table>
                <h2 style="margin-top: 20px; margin-bottom: 10px;">Questions You Analyzed</h2>
                <ul style="list-style-type: disc; padding-left: 20px; font-size: 12px; line-height: 1.5; margin-bottom: 20px;">
                    ${state.selectedQuestions.map((q, i) => `
                        <li><strong>Q${i + 1} (${q.hero}):</strong> ${q.question}</li>
                    `).join('')}
                </ul>
                <h2 style="margin-top: 20px; margin-bottom: 10px;">Interpretation</h2>
                <ul style="list-style-type: disc; padding-left: 20px; font-size: 12px; line-height: 1.5;">
                    <li><strong>Highest scoring option:</strong> The option with the highest score (up to 45) reflects the strongest alignment with the wisdom traditions across spiritual, philosophical, logical, and rational lenses.</li>
                    <li><strong>Score gaps:</strong> Significant differences between option scores indicate varying levels of fit; review lower-scoring options for potential misalignment or blind spots.</li>
                    <li><strong>Low scores overall:</strong> If all totals are below 23, consider refining options or exploring alternatives to better align with the wisdom criteria.</li>
                    <li><strong>Remember:</strong> These scores synthesize diverse perspectives, but your intuition should guide the final decision—wisdom transcends mere numbers.</li>
                </ul>
            `);

            pdf.save(`hero-decision-slideshow-${Date.now()}.pdf`);
        }

        // Render functions
        function renderSetup() {
            return `
                <div class="max-w-2xl mx-auto p-6">
                    <div class="text-center mb-8">
                        <h1 class="text-3xl font-bold text-gray-800 mb-2">Hero Decision Matrix</h1>
                        <p class="text-gray-600">9 focused questions to examine your decision</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg border-2 border-gray-200">
                        <h2 class="text-xl font-bold text-gray-800 mb-4">What decision are you facing?</h2>
                        <textarea id="decisionInput" placeholder="Describe your decision..." class="w-full p-3 border border-gray-300 rounded-lg h-24">${state.decision}</textarea>
                        <h3 class="text-lg font-bold text-gray-800 mt-6 mb-4">What are your options?</h3>
                        <div class="space-y-3">
                            ${state.options.map((option, index) => `
                                <div class="flex items-center space-x-3">
                                    <span class="text-sm font-semibold text-gray-600">Option ${index + 1}:</span>
                                    <input type="text" value="${option}" placeholder="Enter option..." class="flex-1 p-2 border border-gray-300 rounded-lg option-input" data-index="${index}"/>
                                    ${state.options.length > 2 ? `<button onclick="removeOption(${index})" class="text-red-600">×</button>` : ''}
                                </div>
                            `).join('')}
                        </div>
                        ${state.options.length < 5 ? `<button onclick="addOption()" class="mt-3 text-blue-600">+ Add option</button>` : ''}
                        <button id="beginAnalysis" class="w-full mt-6 bg-blue-600 text-white py-3 rounded-lg font-semibold">Begin Analysis</button>
                    </div>
                    <div class="mt-8 p-6 bg-white rounded-lg border-2 border-gray-200">
                        <h3 class="text-lg font-bold text-gray-800 mb-3">Questions You Analyzed</h3>
                        <div class="space-y-2 text-sm text-gray-600">
                            ${state.selectedQuestions.map((q, i) => `
                                <p><strong>Q${i+1} (${q.hero}):</strong> ${q.question}</p>
                            `).join('')}
                        </div>
                        
                        <h4 class="text-lg font-bold text-gray-800 mt-6 mb-3">Interpretation</h4>
                        <div class="space-y-2 text-sm text-gray-600">
                            <p><strong>Highest scoring option:</strong> This shows the strongest overall alignment with the wisdom traditions—your intuitive sense of "suitability" across spiritual, philosophical, logical, and rational lenses.</p>
                            <p><strong>Score gaps:</strong> Wide differences highlight where options diverge in fit; revisit low-scoring areas for potential blind spots in alignment.</p>
                            <p><strong>Low scores overall:</strong> If totals are under 23, some options may not align well—consider refining them or exploring alternatives before committing.</p>
                            <p><strong>Remember:</strong> These suitability scores synthesize diverse perspectives, but trust your gut for the final call—wisdom isn't just numbers.</p>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderQuestions() {
            const currentQuestion = state.selectedQuestions[state.currentStep - 1];
            const totalSteps = 9;

            return `
                <div class="max-w-4xl mx-auto p-6">
                    <div class="text-center mb-8">
                        <h1 class="text-3xl font-bold text-gray-800 mb-2">Hero Decision Matrix</h1>
                        <p class="text-gray-600 mb-4">Decision: <span class="font-semibold">${state.decision}</span></p>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-blue-600 h-2 rounded-full" style="width: ${(state.currentStep / totalSteps) * 100}%"></div>
                        </div>
                        <p class="text-sm text-gray-600 mt-2">Question ${state.currentStep} of ${totalSteps}</p>
                    </div>
                    <div class="${currentQuestion.color} p-6 rounded-lg border-2 mb-6">
                        <h2 class="text-2xl font-bold">${currentQuestion.hero}</h2>
                        <p class="text-sm opacity-80">${currentQuestion.focus}</p>
                        <h3 class="text-lg font-semibold mt-4">${currentQuestion.question}</h3>
                    </div>
                    <div class="space-y-4">
                        ${state.options.map((option, optionIndex) => `
                            <div class="bg-white p-4 rounded-lg border-2 border-gray-200">
                                <h4 class="font-semibold text-gray-800 mb-3">Option ${optionIndex + 1}: ${option}</h4>
                                <div class="rating-container">
                                    ${[1, 2, 3, 4, 5].map(rating => {
                                        const isSelected = state.responses[`${state.currentStep - 1}-${optionIndex}`] === rating;
                                        const label = getRatingLabel(rating);
                                        return `
                                            <div class="rating-group">
                                                <button class="rating-btn ${isSelected ? 'bg-blue-600 border-blue-600 text-white' : 'border-gray-300 hover:border-blue-400'}" onclick="handleRatingClick(${state.currentStep - 1}, ${optionIndex}, ${rating})">${rating}</button>
                                                <div class="rating-label">${label}</div>
                                            </div>
                                        `;
                                    }).join('')}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    <div class="flex justify-between mt-8">
                        <button onclick="goToPrevious()" class="bg-gray-300 text-gray-800 px-6 py-2 rounded-lg">Previous</button>
                        <button onclick="goToNext()" class="bg-blue-600 text-white px-6 py-2 rounded-lg">${state.currentStep < totalSteps ? 'Next' : 'See Results'}</button>
                    </div>
                </div>
            `;
        }

        function renderResults() {
            const scores = calculateScores();
            const maxScore = Math.max(...scores.map(s => s.total));

            return `
                <div class="max-w-4xl mx-auto p-6">
                    <div class="text-center mb-8">
                        <h1 class="text-3xl font-bold text-gray-800 mb-2">Decision Analysis Results</h1>
                        <p class="text-gray-600 mb-4">Decision: <span class="font-semibold">${state.decision}</span></p>
                        <div class="flex justify-center space-x-4 flex-wrap">
                            <button onclick="exportToCSV()" class="bg-green-600 text-white px-4 py-2 rounded-lg text-sm">Export CSV</button>
                            <button onclick="exportToPDF()" class="bg-purple-600 text-white px-4 py-2 rounded-lg text-sm">Export PDF</button>
                            <button onclick="exportSlideshowPDF()" class="bg-blue-600 text-white px-4 py-2 rounded-lg text-sm">Slideshow PDF</button>
                            <button onclick="resetMatrix()" class="bg-gray-600 text-white px-4 py-2 rounded-lg text-sm">New Decision</button>
                        </div>
                    </div>
                    <div class="space-y-6">
                        ${state.options.map((option, index) => {
                            const score = scores[index];
                            const isTop = score.total === maxScore;
                            return `
                                <div class="${isTop ? 'bg-yellow-50 border-yellow-300' : 'bg-white border-gray-200'} p-6 rounded-lg border-2">
                                    <div class="flex items-center justify-between mb-4">
                                        <h3 class="text-xl font-bold text-gray-800">Option ${index + 1}: ${option}</h3>
                                        <span class="text-2xl font-bold text-gray-800">${score.total}/45 ${isTop ? '🏆' : ''}</span>
                                    </div>
                                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                                        ${Object.keys(score.breakdown).map(hero => `
                                            <div class="text-center p-3 bg-gray-100 rounded-lg">
                                                <p class="text-sm font-semibold text-gray-700">${hero}</p>
                                                <p class="text-lg font-bold text-gray-800">${score.breakdown[hero] || 0}</p>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                    
                    <div class="mt-8 p-6 bg-white rounded-lg border-2 border-gray-200">
                        <h3 class="text-lg font-bold text-gray-800 mb-3">Questions You Analyzed</h3>
                        <div class="space-y-2 text-sm text-gray-600">
                            ${state.selectedQuestions.map((q, i) => `
                                <p><strong>Q${i+1} (${q.hero}):</strong> ${q.question}</p>
                            `).join('')}
                        </div>
                        
                        <h4 class="text-lg font-bold text-gray-800 mt-6 mb-3">Interpretation</h4>
                        <div class="space-y-2 text-sm text-gray-600">
                            <p><strong>Highest scoring option:</strong> This shows the strongest overall alignment with the wisdom traditions—your intuitive sense of "suitability" across spiritual, philosophical, logical, and rational lenses.</p>
                            <p><strong>Score gaps:</strong> Wide differences highlight where options diverge in fit; revisit low-scoring areas for potential blind spots in alignment.</p>
                            <p><strong>Low scores overall:</strong> If totals are under 23, some options may not align well—consider refining them or exploring alternatives before committing.</p>
                            <p><strong>Remember:</strong> These suitability scores synthesize diverse perspectives, but trust your gut for the final call—wisdom isn't just numbers.</p>
                        </div>
                    </div>
                </div>
            `;
        }

        // Event handlers
        function handleRatingClick(questionIndex, optionIndex, rating) {
            handleResponse(questionIndex, optionIndex, rating);
            render();
        }

        function goToPrevious() {
            state.currentStep = Math.max(1, state.currentStep - 1);
            render();
        }

        function goToNext() {
            if (state.currentStep < 9) {
                state.currentStep += 1;
                render();
            } else {
                state.showResults = true;
                render();
            }
        }

        function render() {
            const app = document.getElementById('app');
            if (state.showResults) {
                app.innerHTML = renderResults();
            } else if (state.currentStep === 0) {
                app.innerHTML = renderSetup();
                setupEventListeners();
            } else {
                app.innerHTML = renderQuestions();
            }
        }

        function setupEventListeners() {
            const decisionInput = document.getElementById('decisionInput');
            if (decisionInput) {
                decisionInput.addEventListener('input', (e) => {
                    state.decision = e.target.value;
                });
            }

            document.querySelectorAll('.option-input').forEach(input => {
                input.addEventListener('input', (e) => {
                    const index = parseInt(e.target.dataset.index);
                    updateOption(index, e.target.value);
                });
            });

            const beginBtn = document.getElementById('beginAnalysis');
            if (beginBtn) {
                beginBtn.addEventListener('click', () => {
                    if (state.decision.trim() && state.options.every(opt => opt.trim())) {
                        state.selectedQuestions = generateQuestions();
                        state.currentStep = 1;
                        render();
                    }
                });
            }
        }

        // Make functions globally available
        window.addOption = addOption;
        window.removeOption = removeOption;
        window.resetMatrix = resetMatrix;
        window.handleRatingClick = handleRatingClick;
        window.goToPrevious = goToPrevious;
        window.goToNext = goToNext;
        window.exportToCSV = exportToCSV;
        window.exportToPDF = exportToPDF;
        window.exportSlideshowPDF = exportSlideshowPDF;

        // Initial render
        document.addEventListener('DOMContentLoaded', render);
    </script>
</body>
</html>
